<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Automation Host Prerequisites - Automation for OpenShift on IBM Power</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Automation for OpenShift on IBM Power</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../ocp4-upi-powervs/" class="nav-link">Deploying OpenShift on KVM</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../ocp4-upi-powervs/" class="nav-link">Deploying OpenShift on IBM Cloud Power Virtual Servers</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../ocp4-upi-powervm/" class="nav-link">Deploying OpenShift on PowerVM managed via PowerVC</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#automation-host-prerequisites" class="nav-link">Automation Host Prerequisites</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#configure-your-firewall" class="nav-link">Configure Your Firewall</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#automation-host-setup" class="nav-link">Automation Host Setup</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="automation-host-prerequisites">Automation Host Prerequisites</h1>
<!-- TOC -->

<ul>
<li><a href="#automation-host-prerequisites">Automation Host Prerequisites</a></li>
<li><a href="#configure-your-firewall">Configure Your Firewall</a></li>
<li><a href="#automation-host-setup">Automation Host Setup</a><ul>
<li><a href="#terraform">Terraform</a></li>
<li><a href="#terraform-providers">Terraform Providers</a></li>
<li><a href="#git">Git</a></li>
<li><a href="#rhcos-and-rhel-8x-images-for-openshift">RHCOS and RHEL 8.X Images for OpenShift</a></li>
<li><a href="#download-the-rhel-qcow2-image">Download the RHEL Qcow2 image</a><ul>
<li><a href="#customize-the-rhel-qcow2-image">Customize the RHEL Qcow2 image</a></li>
</ul>
</li>
<li><a href="#download-the-rhcos-qcow2-image">Download the RHCOS Qcow2 image</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h2 id="configure-your-firewall">Configure Your Firewall</h2>
<p>If your automation host is behind a firewall, you will need to ensure the following ports are open in order to use ssh, http, and https:
- 22, 443, 80</p>
<p>These additional ports are required for the ocp cli (<code>oc</code>) post-install:
- 6443</p>
<h2 id="automation-host-setup">Automation Host Setup</h2>
<p>Install the following packages on the automation host. Select the appropriate install binaries based on your automation host platform - Mac/Linux.
It's preferable to run this automation code on Linux host since Linux is required for customizing the RHEL image.</p>
<h3 id="terraform">Terraform</h3>
<p><strong>Terraform &gt;= 0.13.0</strong>: Please refer to the <a href="https://learn.hashicorp.com/terraform/getting-started/install.html">link</a> for instructions on installing Terraform. For validating the version run <code>terraform version</code> command after install.</p>
<p><strong>Terraform</strong> binary on IBM Power (<code>ppc64le</code>) is not available for download from Hashicorp website.
You can download it from the following <a href="https://www.power-devops.com/terraform">link-1</a> or <a href="https://oplab9.parqtec.unicamp.br/pub/ppc64el/terraform/">link-2</a> or you will need to compile it from source by running:</p>
<pre><code>TAG_VERSION=v0.13.5
git clone https://github.com/hashicorp/terraform --branch $TAG $GOPATH/src/github.com/hashicorp/terraform
cd $GOPATH/src/github.com/hashicorp/terraform
TF_DEV=1 scripts/build.sh
</code></pre>
<p>Validate using:</p>
<pre><code>$GOPATH/bin/terraform version
</code></pre>
<h3 id="terraform-providers">Terraform Providers</h3>
<p>Please follow the <a href="../terraform-provider-build/">guide</a> to build and install the required Terraform providers.</p>
<h3 id="git">Git</h3>
<p><strong>Git</strong>:  Please refer to the <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">link</a> for instructions on installing Git.</p>
<h3 id="rhcos-and-rhel-8x-images-for-openshift">RHCOS and RHEL 8.X Images for OpenShift</h3>
<p>You'll need to have the RedHat CoreOS (RHCOS) and RHEL 8.2 (or later) image available on the automation host or via an HTTP(S) server.
RHEL 8.x image is used by bastion node, and RHCOS image is used for boostrap, master and worker nodes.</p>
<h4 id="download-the-rhel-qcow2-image">Download the RHEL Qcow2 image</h4>
<ul>
<li>Login to the RedHat portal and click on the <a href="https://access.redhat.com/downloads">Downloads</a> tab.</li>
<li>Click on the product <a href="https://access.redhat.com/downloads/content/479/">Red Hat Enterprise Linux 8</a> from the list.</li>
<li>In the "Product Variant" drop-down select "Red Hat Enterprise Linux for Power, little endian".</li>
<li>In the "Version" drop-down select the version of RHEL you want to download. For example, will use the latest as 8.2.</li>
<li>In the "Product Software" tab, click on "Download Now" button adjacent to "Red Hat Enterprise Linux 8.2 Update KVM Guest Image".</li>
<li>Save the Qcow2 image.</li>
<li>If your automation host is not Linux, then you will need to copy the Qcow2 image to a Linux host for the next step.</li>
</ul>
<h5 id="customize-the-rhel-qcow2-image">Customize the RHEL Qcow2 image</h5>
<p>Customize the Qcow2 image to set a root password and disable the cloud-init service.
You will need the 'libguestfs-tools' package installed on the Linux machine to run the below command (Not available on Mac/Windows).</p>
<pre><code># virt-customize -a &lt;qcow2 image file name&gt; --root-password password:&lt;password&gt; --uninstall cloud-init
[   0.0] Examining the guest ...
[  11.5] Setting a random seed
[  11.5] Uninstalling packages: cloud-init
[  13.9] Setting passwords
[  15.6] Finishing off
</code></pre>
<p>On successful completion, copy the image back to the automation host (if it was not Linux) or make it available via an HTTP(S) server.</p>
<p>Update the following Terraform input variables:
 * <code>rhel_password = "&lt;password&gt;"</code></p>
<h4 id="download-the-rhcos-qcow2-image">Download the RHCOS Qcow2 image</h4>
<ul>
<li>Select the RHCOS version you need from the <a href="http://mirror.openshift.com/pub/openshift-v4/ppc64le/dependencies/rhcos/">OpenShift mirror</a>.</li>
<li>Find and download the QEMU qcow2 image gzip file. eg: rhcos-4.4.9-ppc64le-qemu.ppc64le.qcow2.gz</li>
<li>Extract the Qcow2 image and place it on the automation host or make it available via an HTTP(S) server.</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
